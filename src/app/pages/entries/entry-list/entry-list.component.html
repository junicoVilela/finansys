<app-bread-crumb
        [items]="[{text: 'Lançamentos'}]"
></app-bread-crumb>

<app-page-header
        page-title="Lançamentos"
        button-text="+ Novo Lançamento"
        button-link="new"
        button-class="btn-success"
></app-page-header>

<div class="my-3 p-3 bg-body rounded shadow-sm">
    <h4 class="pb-4 text-opacity-25">Lista de lançamentos</h4>
    
    <div *ngIf="isLoading" class="text-center p-4">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Carregando...</span>
        </div>
        <p class="mt-2">Carregando lançamentos...</p>
    </div>
    
    <div *ngIf="!isLoading && resources.length === 0" class="text-center p-4 text-muted">
        <p>Nenhum lançamento encontrado.</p>
        <a routerLink="new" class="btn btn-primary">Criar primeiro lançamento</a>
    </div>
    
    <table *ngIf="!isLoading && resources.length > 0" class="table table-bordered table-hover caption-top">
        <thead class="table-light">
        <tr>
            <th scope="col" class="p-2">Lançamento</th>
            <th scope="col" class="p-2">Categoria</th>
            <th scope="col" class="p-2 text-end">Valor</th>
            <th scope="col" class="p-2 text-center">Ações</th>
        </tr>
        </thead>
        <tbody>
            <tr *ngFor="let entry of resources">
                <td>
                    <strong>{{ entry.name }}</strong><br>
                    <small class="text-success">{{ entry.date | dateFormat }}</small><br>
                    <small *ngIf="entry.description">{{ entry.description }}</small>
                </td>
                <td>
                    {{ entry.category?.name }}
                </td>
                <td class="text-end">
                    <strong
                        [class.text-success]="entry.type === 'revenue'"
                        [class.text-danger]="entry.type === 'expense'">
                        {{ entry.amount | currency:'BRL' }}
                    </strong><br>
                    <span 
                        class="badge"
                        [ngClass]="entry.paid ? 'bg-success' : 'bg-danger'">
                        {{ entry.paid ? 'Pago' : 'Pendente' }}
                    </span>
                </td>
                <td class="text-center">
                    <a [routerLink]="[entry.id, 'edit']" class="btn btn-outline-info btn-sm m-1">Editar</a>
                    <button (click)="deleteResource(entry)" class="btn btn-outline-danger btn-sm m-1">Deletar</button>
                </td>
            </tr>
        </tbody>
    </table>
</div>